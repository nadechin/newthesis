\chapter{実装}
\label{impl}

本章では，低対話型Honeypotと高対話型Honeypotの設置環境についても示し，~\ref{meth:appr}節で述べた手法を用いて純正のHoneypotにどのようなコマンドを実装し，Honeypot特有の異常な挙動を修正したのかを説明する．

\section{実装環境}
本研究で実装するシステムを構成するためのハードウェアおよびソフトウェアについて説明する．表\ref{table:imple}に詳細なバージョンを示す．
\label{impl:env}

% -------------------
\vspace{3mm}
%\newlength{\myheight}
\setlength{\myheight}{10mm}
\begin{table}[h]
 \caption{実装環境}
 \label{table:imple}
 \centering
  \begin{tabular}{|c|c|c|}
   \hline
   ハードウェア/ソフトウェア & 実装環境 & Version(date)  \\
    \hline \hline
     \parbox[c][\myheight][c]{0cm}{} 純正のCowrie  & CentOS5 & 1．4．0  \\
     \hline
     \parbox[c][\myheight][c]{0cm}{} 修正済みのCowrie  & CentOS5 & 1．4．0（self made）  \\
     \hline
     \parbox[c][\myheight][c]{0cm}{} Honeywall  & CentOS5 & 1．4  \\
     \hline
  \end{tabular}
\end{table}
\vspace{7mm}
% --------------------

\subsection{純正のHoneypotで未実装のコマンドの実装}
\label{impl:ImplBusyBox}
本研究において純正のHoneypotはCowrie\cite{cowrie}を使用し，実際のShellには実装されているが，純正のHoneypotで未実装のコマンドについてはBusyBox\cite{busybox}に含まれるコマンドの実装を行なった．~\ref{tech:BusyBox}や~\ref{Cowrie}で紹介した通り，BusyBoxに含まれるコマンドの種類が219ある中で，Cowrieの実装コマンド数は92しか存在しない．この差分をPythonで実装する． \\
またBusyBoxに含まれるコマンドとCowrieの実装コマンドの一覧を表\ref{table:command}に示す． \\
\clearpage
% -------------------

%\geometry
 
\begin{center}
\large{\textbf{実装コマンド一覧}}
\end{center}

BusyBoxに含まれるコマンドとCowrieの実装コマンドの一覧
 
\begin{longtable}{p{64mm}p{64mm}}
  \caption{実装コマンド一覧}
  \label{table:command} \\
  %------ 最初のページの表の最上部 ----
  \hline
  Cowrieの実装コマンド　& Busyboxに含まれるコマンド \\ \hline\hline
  \endfirsthead
  %------ 2ページ以降の表の最上部 ----
  \multicolumn{2}{r}{前ページからの続き} \\ \hline
  Cowrieの実装コマンド　& Busyboxに含まれるコマンド \\ \hline\hline
  \endhead
  %----- ページの表の最下部 --------
  \hline
  \multicolumn{2}{r}{次ページに続く} \\
  \endfoot
  %----- 最終ページの表の最下部 --------
  \hline
  \multicolumn{2}{r}{以上} \\
  \endlastfoot

     adduser & acpid  \\
     \hline
     alias & adjtimex  \\
     \hline
     apt-get & ar  \\
     \hline
     base64 & arp  \\
     \hline
     bash & arping  \\
     \hline
     busybox & ash  \\
     \hline
     cat & awk  \\
     \hline
     cd & basename  \\
     \hline
     chattr & blockdev  \\
     \hline
     chgrp & brctl  \\
     \hline
     chmod & bunzip2  \\
     \hline
     chown & bzcat  \\
     \hline
     clear & bzip2  \\
     \hline
     cp & cal  \\
     \hline
     curl & cat  \\
     \hline
     date & chgrp  \\
     \hline
     dd & chmod  \\
     \hline
     dget & chown  \\
     \hline
     dir & chpasswd \\
     \hline
     du & chroot \\
     \hline
     echo & chvt \\
     \hline
     egrep & clear \\
     \hline
     env & cmp \\
     \hline
     ethtool & cp \\
     \hline
     exit & cpio \\
     \hline
     export & crond \\
     \hline
     fgrep & crontab \\
     \hline
     free & cttyhack \\
     \hline
     ftpget & cut \\
     \hline
     gcc & date \\
     \hline
     grep & dc \\
     \hline
     halt & dd \\
     \hline
     head & deallocvt \\
     \hline
     help & depmod \\
     \hline
     history & devmem \\
     \hline
     hostname & df \\
     \hline
     id & diff \\
     \hline
     ifconfig & dirname \\
     \hline
     iptables & dmesg \\
     \hline
     jobs & dnsdomainname \\
     \hline
     kill & dos2unix \\
     \hline
     killall & dpkg \\
     \hline
     killall5 & dpkg-deb \\
     \hline
     last & du \\
     \hline
     logout & dumpkmap \\
     \hline
     ls & dumpleases \\
     \hline
     mkdir & echo \\
     \hline
     mv & ed \\
     \hline
     nc & egrep \\
     \hline
     netstat & env \\
     \hline
     nohup & expand \\
     \hline
     passwd & expr \\
     \hline
     perl & FALSE \\
     \hline
     php & fdisk \\
     \hline
     ping & fgrep \\
     \hline
     pkill & find \\
     \hline
     poweroff & fold \\
     \hline
     printf & free \\
     \hline
     ps & freeramdisk \\
     \hline
     pwd & fstrim \\
     \hline
     python & ftpget \\
     \hline
     reboot & ftpput \\
     \hline
     reset & getopt \\
     \hline
     rm & getty \\
     \hline
     rmdir & grep \\
     \hline
     scp & groups \\
     \hline
     service & gunzip \\
     \hline
     set & gzip \\
     \hline
     sh & halt \\
     \hline
     shutdown & head \\
     \hline
     sleep & hexdump \\
     \hline
     ssh & hostid \\
     \hline
     su & hostname \\
     \hline
     sudo & httpd \\
     \hline
     tail & hwclock \\
     \hline
     tar & id \\
     \hline
     tftp & ifconfig \\
     \hline
     touch & ifdown \\
     \hline
     ulimit & ifup \\
     \hline
     umask & init \\
     \hline
     uname & insmod \\
     \hline
     unset & ionice \\
     \hline
     uptime & ip \\
     \hline
     useradd & ipcalc \\
     \hline
     users & kill \\
     \hline
     w & killall \\
     \hline
     wget & klogd \\
     \hline
     which & last \\
     \hline
     who & less \\
     \hline
     whoami & ln \\
     \hline
     yes & loadfont \\
     \hline
     yum & loadkmap \\
     \hline
      & logger \\
     \hline
      & login \\
     \hline
      & logname \\
     \hline
      & logread \\
     \hline
      & losetup \\
     \hline
      & ls \\
     \hline
      & lsmod \\
     \hline
      & lzcat \\
     \hline
      & lzma \\
     \hline
      & lzop \\
     \hline
      & lzopcat \\
     \hline
      & md5sum \\
     \hline
      & mdev \\
     \hline
      & microcom \\
     \hline
      & mkdir \\
     \hline
      & mkfifo \\
     \hline
      & mknod \\
     \hline
      & mkswap \\
     \hline
      & mktemp \\
     \hline
      & modinfo \\
     \hline
      & modprobe \\
     \hline
      & more \\
     \hline
      & mount \\
     \hline
      & mt \\
     \hline
      & mv \\
     \hline
      & nameif \\
     \hline
      & nc \\
     \hline
      & netstat \\
     \hline
      & nslookup \\
     \hline
      & od \\
     \hline
      & openvt \\
     \hline
      & passwd \\
     \hline
      & patch \\
     \hline
      & pidof \\
     \hline
      & ping \\
     \hline
      & ping6 \\
     \hline
      & pivot\_root \\
     \hline
      & poweroff \\
     \hline
      & printf \\
     \hline
      & ps \\
     \hline
      & pwd \\
     \hline
      & rdate \\
     \hline
      & readlink \\
     \hline
      & realpath \\
     \hline
      & reboot \\
     \hline
      & renice \\
     \hline
      & reset \\
     \hline
      & rev \\
     \hline
      & rm \\
     \hline
      & rmdir \\
     \hline
      & rmmod \\
     \hline
      & route \\
     \hline
      & rpm \\
     \hline
      & rpm2cpio \\
     \hline
      & run-parts \\
     \hline
      & sed \\
     \hline
      & seq \\
     \hline
      & setkeycodes \\
     \hline
      & setsid \\
     \hline
      & sh \\
     \hline
      & sha1sum \\
     \hline
      & sha256sum \\
     \hline
      & sha512sum \\
     \hline
      & sleep \\
     \hline
      & sort \\
     \hline
      & start-stop-daemon \\
     \hline
      & stat \\
     \hline
      & static-sh \\
     \hline
      & strings \\
     \hline
      & stty \\
     \hline
      & su \\
     \hline
      & sulogin \\
     \hline
      & swapoff \\
     \hline
      & swapon \\
     \hline
      & switch\_root \\
     \hline
      & sync \\
     \hline
      & sysctl \\
     \hline
      & syslogd \\
     \hline
      & tac \\
     \hline
      & tail \\
     \hline
      & tar \\
     \hline
      & taskset \\
     \hline
      & tee \\
     \hline
      & telnet \\
     \hline
      & telnetd \\
     \hline
      & test \\
     \hline
      & tftp \\
     \hline
      & time \\
     \hline
      & timeout \\
     \hline
      & top \\
     \hline
      & touch \\
     \hline
      & tr \\
     \hline
      & traceroute \\
     \hline
      & traceroute6 \\
     \hline
      & TRUE \\
     \hline
      & tty \\
     \hline
      & tunctl \\
     \hline
      & udhcpc \\
     \hline
      & udhcpd \\
     \hline
      & umount \\
     \hline
      & uname \\
     \hline
      & uncompress \\
     \hline
      & unexpand \\
     \hline
      & uniq \\
     \hline
      & unix2dos \\
     \hline
      & unlzma \\
     \hline
      & unlzop \\
     \hline
      & unxz \\
     \hline
      & unzip \\
     \hline
      & uptime \\
     \hline
      & usleep \\
     \hline
      & uudecode \\
     \hline
      & uuencode \\
     \hline
      & vconfig \\
     \hline
      & vi \\
     \hline
      & watch \\
     \hline
      & watchdog \\
     \hline
      & wc \\
     \hline
      & wget \\
     \hline
      & which \\
     \hline
      & who \\
     \hline
      & whoami \\
     \hline
      & xargs \\
     \hline
      & xz \\
     \hline
      & xzcat \\
     \hline
      & yes \\
     \hline
      & zcat \\
     \hline
\end{longtable}
%\vspace{3mm}
%\setlength{\myheight}{10mm}
%\begin{table}[h]
% \caption{実装コマンド一覧}
% \label{table:command}
% \centering
%  \begin{tabular}{|c|c|}
%   \hline
%   Busyboxに含まれるコマンド & Cowrieの実装コマンド  \\
%    \hline \hline
%  \end{tabular}
%\end{table}
%\vspace{7mm}
% --------------------

%%% Local Variables:
%%% mode: japanese-latex
%%% TeX-master: "．．/bthesis"
%%% End:
