\chapter{実装}
\label{impl}

本章では，低対話型Honeypotと高対話型Honeypotの設置環境についても示し，~\ref{meth:appr}節で述べた手法を用いて純正のHoneypotにどのようなコマンドを実装し，Honeypot特有の異常な挙動を修正したのかを説明する．

\section{実装環境}
本研究で実装するシステムを構成するためのハードウェアおよびソフトウェアについて説明する．表\ref{table:imple}に詳細なバージョンを示す．
\label{impl:env}

% -------------------
\vspace{3mm}
%\newlength{\myheight}
\setlength{\myheight}{10mm}
\begin{table}[h]
 \caption{実装環境}
 \label{table:imple}
 \centering
  \begin{tabular}{|c|c|c|}
   \hline
   ハードウェア/ソフトウェア & 実装環境 & Version(date)  \\
    \hline \hline
     \parbox[c][\myheight][c]{0cm}{} 純正のCowrie  & CentOS5 & 1．4．0  \\
     \hline
     \parbox[c][\myheight][c]{0cm}{} 修正済みのCowrie  & CentOS5 & 1．4．0（self made）  \\
     \hline
     \parbox[c][\myheight][c]{0cm}{} Honeywall  & CentOS5 & 1．4  \\
     \hline
  \end{tabular}
\end{table}
\vspace{7mm}
% --------------------

\subsection{純正のHoneypotで未実装のコマンドの実装}
\label{impl:ImplBusyBox}
本研究において純正のHoneypotはCowrie\cite{cowrie}を使用し，実際のShellには実装されているが，純正のHoneypotで未実装のコマンドについてはBusyBox\cite{busybox}に含まれるコマンドの実装を行なった．~\ref{tech:BusyBox}や~\ref{Cowrie}で紹介した通り，BusyBoxに含まれるコマンドの種類が219ある中で，Cowrieの実装コマンド数は92しか存在しない．この差分をPythonで実装する． \\
またBusyBoxに含まれるコマンドとCowrieの実装コマンドの一覧を表\ref{table:command}に示す． \\
\clearpage
% -------------------

%\geometry
 
\begin{center}
\large{\textbf{実装コマンド一覧}}
\end{center}

BusyBoxに含まれるコマンドとCowrieの実装コマンドの一覧
 
\begin{longtable}{llp{50mm}}
  \caption{実装コマンド一覧}
  \label{table:command} \\
  %------ 最初のページの表の最上部 ----
  \hline
  Cowrieの実装コマンド & Busyboxに含まれるコマンド & Cowrieに未実装のコマンド \\ \hline\hline
  \endfirsthead
  %------ 2ページ以降の表の最上部 ----
  \multicolumn{3}{r}{前ページからの続き} \\ \hline
  Cowrieの実装コマンド　& Busyboxに含まれるコマンド & Cowrieに未実装のコマンド \\ \hline\hline
  \endhead
  %----- ページの表の最下部 --------
  \hline
  \multicolumn{3}{r}{次ページに続く} \\
  \endfoot
  %----- 最終ページの表の最下部 --------
  \hline
  \multicolumn{3}{r}{以上} \\
  \endlastfoot

adduser & acpid & acpid \\ \hline
alias & adjtimex & adjtimex \\ \hline
apt-get & ar & ar \\ \hline
base64 & arp & arp \\ \hline
bash & arping & arping \\ \hline
busybox & ash & ash \\ \hline
cat & awk & awk \\ \hline
cd & basename & basename \\ \hline
chattr & blockdev & blockdev \\ \hline
chgrp & brctl & brctl \\ \hline
chmod & bunzip2 & bunzip2 \\ \hline
chown & bzcat & bzcat \\ \hline
clear & bzip2 & bzip2 \\ \hline
cp & cal & cal \\ \hline
curl & cat & chpasswd \\ \hline
date & chgrp & chroot \\ \hline
dd & chmod & chvt \\ \hline
dget & chown & cmp \\ \hline
dir & chpasswd & cpio \\ \hline
du & chroot & crond \\ \hline
echo & chvt & crontab \\ \hline
egrep & clear & cttyhack \\ \hline
env & cmp & cut \\ \hline
ethtool & cp & dc \\ \hline
exit & cpio & deallocvt \\ \hline
export & crond & depmod \\ \hline
fgrep & crontab & devmem \\ \hline
free & cttyhack & df \\ \hline
ftpget & cut & diff \\ \hline
gcc & date & dirname \\ \hline
grep & dc & dmesg \\ \hline
halt & dd & dnsdomainname \\ \hline
head & deallocvt & dos2unix \\ \hline
help & depmod & dpkg \\ \hline
history & devmem & dpkg-deb \\ \hline
hostname & df & dumpkmap \\ \hline
id & diff & dumpleases \\ \hline
ifconfig & dirname & ed \\ \hline
iptables & dmesg & expand \\ \hline
jobs & dnsdomainname & expr \\ \hline
kill & dos2unix & FALSE \\ \hline
killall & dpkg & fdisk \\ \hline
killall5 & dpkg-deb & find \\ \hline
last & du & fold \\ \hline
logout & dumpkmap & freeramdisk \\ \hline
ls & dumpleases & fstrim \\ \hline
mkdir & echo & ftpput \\ \hline
mv & ed & getopt \\ \hline
nc & egrep & getty \\ \hline
netstat & env & groups \\ \hline
nohup & expand & gunzip \\ \hline
passwd & expr & gzip \\ \hline
perl & FALSE & hexdump \\ \hline
php & fdisk & hostid \\ \hline
ping & fgrep & httpd \\ \hline
pkill & find & hwclock \\ \hline
poweroff & fold & ifdown \\ \hline
printf & free & ifup \\ \hline
ps & freeramdisk & init \\ \hline
pwd & fstrim & insmod \\ \hline
python & ftpget & ionice \\ \hline
reboot & ftpput & ip \\ \hline
reset & getopt & ipcalc \\ \hline
rm & getty & klogd \\ \hline
rmdir & grep & less \\ \hline
scp & groups & ln \\ \hline
service & gunzip & loadfont \\ \hline
set & gzip & loadkmap \\ \hline
sh & halt & logger \\ \hline
shutdown & head & login \\ \hline
sleep & hexdump & logname \\ \hline
ssh & hostid & logread \\ \hline
su & hostname & losetup \\ \hline
sudo & httpd & lsmod \\ \hline
tail & hwclock & lzcat \\ \hline
tar & id & lzma \\ \hline
tftp & ifconfig & lzop \\ \hline
touch & ifdown & lzopcat \\ \hline
ulimit & ifup & md5sum \\ \hline
umask & init & mdev \\ \hline
uname & insmod & microcom \\ \hline
unset & ionice & mkfifo \\ \hline
uptime & ip & mknod \\ \hline
useradd & ipcalc & mkswap \\ \hline
users & kill & mktemp \\ \hline
w & killall & modinfo \\ \hline
wget & klogd & modprobe \\ \hline
which & last & more \\ \hline
who & less & mount \\ \hline
whoami & ln & mt \\ \hline
yes & loadfont & nameif \\ \hline
yum & loadkmap & nslookup \\ \hline
 & logger & od \\ \hline
 & login & openvt \\ \hline
 & logname & patch \\ \hline
 & logread & pidof \\ \hline
 & losetup & ping6 \\ \hline
 & ls & pivot\_root \\ \hline
 & lsmod & rdate \\ \hline
 & lzcat & readlink \\ \hline
 & lzma & realpath \\ \hline
 & lzop & renice \\ \hline
 & lzopcat & rev \\ \hline
 & md5sum & rmmod \\ \hline
 & mdev & route \\ \hline
 & microcom & rpm \\ \hline
 & mkdir & rpm2cpio \\ \hline
 & mkfifo & run-parts \\ \hline
 & mknod & sed \\ \hline
 & mkswap & seq \\ \hline
 & mktemp & setkeycodes \\ \hline
 & modinfo & setsid \\ \hline
 & modprobe & sha1sum \\ \hline
 & more & sha256sum \\ \hline
 & mount & sha512sum \\ \hline
 & mt & sort \\ \hline
 & mv & start-stop-daemon \\ \hline
 & nameif & stat \\ \hline
 & nc & static-sh \\ \hline
 & netstat & strings \\ \hline
 & nslookup & stty \\ \hline
 & od & sulogin \\ \hline
 & openvt & swapoff \\ \hline
 & passwd & swapon \\ \hline
 & patch & switch\_root \\ \hline
 & pidof & sync \\ \hline
 & ping & sysctl \\ \hline
 & ping6 & syslogd \\ \hline
 & pivot\_root & tac \\ \hline
 & poweroff & taskset \\ \hline
 & printf & tee \\ \hline
 & ps & telnet \\ \hline
 & pwd & telnetd \\ \hline
 & rdate & test \\ \hline
 & readlink & time \\ \hline
 & realpath & timeout \\ \hline
 & reboot & top \\ \hline
 & renice & tr \\ \hline
 & reset & traceroute \\ \hline
 & rev & traceroute6 \\ \hline
 & rm & TRUE \\ \hline
 & rmdir & tty \\ \hline
 & rmmod & tunctl \\ \hline
 & route & udhcpc \\ \hline
 & rpm & udhcpd \\ \hline
 & rpm2cpio & umount \\ \hline
 & run-parts & uncompress \\ \hline
 & sed & unexpand \\ \hline
 & seq & uniq \\ \hline
 & setkeycodes & unix2dos \\ \hline
 & setsid & unlzma \\ \hline
 & sh & unlzop \\ \hline
 & sha1sum & unxz \\ \hline
 & sha256sum & unzip \\ \hline
 & sha512sum & usleep \\ \hline
 & sleep & uudecode \\ \hline
 & sort & uuencode \\ \hline
 & start-stop-daemon & vconfig \\ \hline
 & stat & vi \\ \hline
 & static-sh & watch \\ \hline
 & strings & watchdog \\ \hline
 & stty & wc \\ \hline
 & su & xargs \\ \hline
 & sulogin & xz \\ \hline
 & swapoff & xzcat \\ \hline
 & swapon & zcat \\ \hline
 & switch\_root &  \\ \hline
 & sync &  \\ \hline
 & sysctl &  \\ \hline
 & syslogd &  \\ \hline
 & tac &  \\ \hline
 & tail &  \\ \hline
 & tar &  \\ \hline
 & taskset &  \\ \hline
 & tee &  \\ \hline
 & telnet &  \\ \hline
 & telnetd &  \\ \hline
 & test &  \\ \hline
 & tftp &  \\ \hline
 & time &  \\ \hline
 & timeout &  \\ \hline
 & top &  \\ \hline
 & touch &  \\ \hline
 & tr &  \\ \hline
 & traceroute &  \\ \hline
 & traceroute6 &  \\ \hline
 & TRUE &  \\ \hline
 & tty &  \\ \hline
 & tunctl &  \\ \hline
 & udhcpc &  \\ \hline
 & udhcpd &  \\ \hline
 & umount &  \\ \hline
 & uname &  \\ \hline
 & uncompress &  \\ \hline
 & unexpand &  \\ \hline
 & uniq &  \\ \hline
 & unix2dos &  \\ \hline
 & unlzma &  \\ \hline
 & unlzop &  \\ \hline
 & unxz &  \\ \hline
 & unzip &  \\ \hline
 & uptime &  \\ \hline
 & usleep &  \\ \hline
 & uudecode &  \\ \hline
 & uuencode &  \\ \hline
 & vconfig &  \\ \hline
 & vi &  \\ \hline
 & watch &  \\ \hline
 & watchdog &  \\ \hline
 & wc &  \\ \hline
 & wget &  \\ \hline
 & which &  \\ \hline
 & who &  \\ \hline
 & whoami &  \\ \hline
 & xargs &  \\ \hline
 & xz &  \\ \hline
 & xzcat &  \\ \hline
 & yes &  \\ \hline
 & zcat &  \\ \hline

\end{longtable}
%\vspace{3mm}
%\setlength{\myheight}{10mm}
%\begin{table}[h]
% \caption{実装コマンド一覧}
% \label{table:command}
% \centering
%  \begin{tabular}{|c|c|}
%   \hline
%   Busyboxに含まれるコマンド & Cowrieの実装コマンド  \\
%    \hline \hline
%  \end{tabular}
%\end{table}
%\vspace{7mm}
% --------------------

%%% Local Variables:
%%% mode: japanese-latex
%%% TeX-master: "．．/bthesis"
%%% End:
