\chapter{実装}
\label{impl}

本章では，低対話型Honeypotと高対話型Honeypotの設置環境についても示し，~\ref{meth:appr}節で述べた手法を用いて純正のHoneypotにどのようなコマンドを実装し，Honeypot特有の異常な挙動を修正したのかを説明する．

\section{実装環境}
本研究で実装するシステムを構成するためのハードウェアおよびソフトウェアについて説明する．表\ref{table:imple}に詳細なバージョンを示す．
\label{impl:env}

% -------------------
\vspace{3mm}
%\newlength{\myheight}
\setlength{\myheight}{10mm}
\begin{table}[h]
 \caption{実装環境}
 \label{table:imple}
 \centering
  \begin{tabular}{|c|c|c|}
   \hline
   ハードウェア/ソフトウェア & 実装環境 & Version(date)  \\
    \hline \hline
     \parbox[c][\myheight][c]{0cm}{} 純正のCowrie  & CentOS5 & 1．4．0  \\
     \hline
     \parbox[c][\myheight][c]{0cm}{} 修正済みのCowrie  & CentOS5 & 1．4．0（self made）  \\
     \hline
     \parbox[c][\myheight][c]{0cm}{} Honeywall  & CentOS5 & 1．4  \\
     \hline
  \end{tabular}
\end{table}
\vspace{7mm}
% --------------------

\subsection{純正のHoneypotで未実装のコマンドの実装}
\label{impl:ImplBusyBox}
本研究において純正のHoneypotはCowrie\cite{cowrie}を使用し，実際のShellには実装されているが，純正のHoneypotで未実装のコマンドについてはBusyBox\cite{busybox}に含まれるコマンドの実装を行なった．~\ref{tech:BusyBox}や~\ref{Cowrie}で紹介した通り，BusyBoxに含まれるコマンドの種類が219ある中で，Cowrieの実装コマンド数は92しか存在しない．この差分をPythonで実装する． \\
またBusyBoxに含まれるコマンドとCowrieの実装コマンドの一覧を表\ref{table:command}に示す． \\
\clearpage
% -------------------

%\geometry
 
\begin{center}
\large{\textbf{実装コマンド一覧}}
\end{center}

BusyBoxに含まれるコマンドとCowrieの実装コマンドの一覧
 
\begin{longtable}{llp{64mm}}
  \caption{実装コマンド一覧}
  \label{table:command} \\
  %------ 最初のページの表の最上部 ----
  \hline
  Cowrieの実装コマンド　& Busyboxに含まれるコマンド \\ \hline\hline
  \endfirsthead
  %------ 2ページ以降の表の最上部 ----
  \multicolumn{3}{r}{前ページからの続き} \\ \hline
  Cowrieの実装コマンド　& Busyboxに含まれるコマンド \\ \hline\hline
  \endhead
  %----- ページの表の最下部 --------
  \hline
  \multicolumn{3}{r}{次ページに続く} \\
  \endfoot
  %----- 最終ページの表の最下部 --------
  \hline
  \multicolumn{3}{r}{以上} \\
  \endlastfoot

adduser & acpid & acpid \\ \hline
alias & adjtimex & adjtimex \\ \hline
apt-get & ar & ar \\ \hline
base64 & arp & arp \\ \hline
bash & arping & arping \\ \hline
busybox & ash & ash \\ \hline
cat & awk & awk \\ \hline
cd & basename & basename \\ \hline
chattr & blockdev & blockdev \\ \hline
chgrp & brctl & brctl \\ \hline
chmod & bunzip2 & bunzip2 \\ \hline
chown & bzcat & bzcat \\ \hline
clear & bzip2 & bzip2 \\ \hline
cp & cal & cal \\ \hline
curl & cat & chpasswd \\ \hline
date & chgrp & chroot \\ \hline
dd & chmod & chvt \\ \hline
dget & chown & cmp \\ \hline
dir & chpasswd & cpio \\ \hline
du & chroot & crond \\ \hline
echo & chvt & crontab \\ \hline
egrep & clear & cttyhack \\ \hline
env & cmp & cut \\ \hline
ethtool & cp & dc \\ \hline
exit & cpio & deallocvt \\ \hline
export & crond & depmod \\ \hline
fgrep & crontab & devmem \\ \hline
free & cttyhack & df \\ \hline
ftpget & cut & diff \\ \hline
gcc & date & dirname \\ \hline
grep & dc & dmesg \\ \hline
halt & dd & dnsdomainname \\ \hline
head & deallocvt & dos2unix \\ \hline
help & depmod & dpkg \\ \hline
history & devmem & dpkg-deb \\ \hline
hostname & df & dumpkmap \\ \hline
id & diff & dumpleases \\ \hline
ifconfig & dirname & ed \\ \hline
iptables & dmesg & expand \\ \hline
jobs & dnsdomainname & expr \\ \hline
kill & dos2unix & FALSE \\ \hline
killall & dpkg & fdisk \\ \hline
killall5 & dpkg-deb & find \\ \hline
last & du & fold \\ \hline
logout & dumpkmap & freeramdisk \\ \hline
ls & dumpleases & fstrim \\ \hline
mkdir & echo & ftpput \\ \hline
mv & ed & getopt \\ \hline
nc & egrep & getty \\ \hline
netstat & env & groups \\ \hline
nohup & expand & gunzip \\ \hline
passwd & expr & gzip \\ \hline
perl & FALSE & hexdump \\ \hline
php & fdisk & hostid \\ \hline
ping & fgrep & httpd \\ \hline
pkill & find & hwclock \\ \hline
poweroff & fold & ifdown \\ \hline
printf & free & ifup \\ \hline
ps & freeramdisk & init \\ \hline
pwd & fstrim & insmod \\ \hline
python & ftpget & ionice \\ \hline
reboot & ftpput & ip \\ \hline
reset & getopt & ipcalc \\ \hline
rm & getty & klogd \\ \hline
rmdir & grep & less \\ \hline
scp & groups & ln \\ \hline
service & gunzip & loadfont \\ \hline
set & gzip & loadkmap \\ \hline
sh & halt & logger \\ \hline
shutdown & head & login \\ \hline
sleep & hexdump & logname \\ \hline
ssh & hostid & logread \\ \hline
su & hostname & losetup \\ \hline
sudo & httpd & lsmod \\ \hline
tail & hwclock & lzcat \\ \hline
tar & id & lzma \\ \hline
tftp & ifconfig & lzop \\ \hline
touch & ifdown & lzopcat \\ \hline
ulimit & ifup & md5sum \\ \hline
umask & init & mdev \\ \hline
uname & insmod & microcom \\ \hline
unset & ionice & mkfifo \\ \hline
uptime & ip & mknod \\ \hline
useradd & ipcalc & mkswap \\ \hline
users & kill & mktemp \\ \hline
w & killall & modinfo \\ \hline
wget & klogd & modprobe \\ \hline
which & last & more \\ \hline
who & less & mount \\ \hline
whoami & ln & mt \\ \hline
yes & loadfont & nameif \\ \hline
yum & loadkmap & nslookup \\ \hline
NULL & logger & od \\ \hline
NULL & login & openvt \\ \hline
NULL & logname & patch \\ \hline
NULL & logread & pidof \\ \hline
NULL & losetup & ping6 \\ \hline
NULL & ls & pivot_root \\ \hline
NULL & lsmod & rdate \\ \hline
NULL & lzcat & readlink \\ \hline
NULL & lzma & realpath \\ \hline
NULL & lzop & renice \\ \hline
NULL & lzopcat & rev \\ \hline
NULL & md5sum & rmmod \\ \hline
NULL & mdev & route \\ \hline
NULL & microcom & rpm \\ \hline
NULL & mkdir & rpm2cpio \\ \hline
NULL & mkfifo & run-parts \\ \hline
NULL & mknod & sed \\ \hline
NULL & mkswap & seq \\ \hline
NULL & mktemp & setkeycodes \\ \hline
NULL & modinfo & setsid \\ \hline
NULL & modprobe & sha1sum \\ \hline
NULL & more & sha256sum \\ \hline
NULL & mount & sha512sum \\ \hline
NULL & mt & sort \\ \hline
NULL & mv & start-stop-daemon \\ \hline
NULL & nameif & stat \\ \hline
NULL & nc & static-sh \\ \hline
NULL & netstat & strings \\ \hline
NULL & nslookup & stty \\ \hline
NULL & od & sulogin \\ \hline
NULL & openvt & swapoff \\ \hline
NULL & passwd & swapon \\ \hline
NULL & patch & switch_root \\ \hline
NULL & pidof & sync \\ \hline
NULL & ping & sysctl \\ \hline
NULL & ping6 & syslogd \\ \hline
NULL & pivot_root & tac \\ \hline
NULL & poweroff & taskset \\ \hline
NULL & printf & tee \\ \hline
NULL & ps & telnet \\ \hline
NULL & pwd & telnetd \\ \hline
NULL & rdate & test \\ \hline
NULL & readlink & time \\ \hline
NULL & realpath & timeout \\ \hline
NULL & reboot & top \\ \hline
NULL & renice & tr \\ \hline
NULL & reset & traceroute \\ \hline
NULL & rev & traceroute6 \\ \hline
NULL & rm & TRUE \\ \hline
NULL & rmdir & tty \\ \hline
NULL & rmmod & tunctl \\ \hline
NULL & route & udhcpc \\ \hline
NULL & rpm & udhcpd \\ \hline
NULL & rpm2cpio & umount \\ \hline
NULL & run-parts & uncompress \\ \hline
NULL & sed & unexpand \\ \hline
NULL & seq & uniq \\ \hline
NULL & setkeycodes & unix2dos \\ \hline
NULL & setsid & unlzma \\ \hline
NULL & sh & unlzop \\ \hline
NULL & sha1sum & unxz \\ \hline
NULL & sha256sum & unzip \\ \hline
NULL & sha512sum & usleep \\ \hline
NULL & sleep & uudecode \\ \hline
NULL & sort & uuencode \\ \hline
NULL & start-stop-daemon & vconfig \\ \hline
NULL & stat & vi \\ \hline
NULL & static-sh & watch \\ \hline
NULL & strings & watchdog \\ \hline
NULL & stty & wc \\ \hline
NULL & su & xargs \\ \hline
NULL & sulogin & xz \\ \hline
NULL & swapoff & xzcat \\ \hline
NULL & swapon & zcat \\ \hline
NULL & switch_root & NULL \\ \hline
NULL & sync & NULL \\ \hline
NULL & sysctl & NULL \\ \hline
NULL & syslogd & NULL \\ \hline
NULL & tac & NULL \\ \hline
NULL & tail & NULL \\ \hline
NULL & tar & NULL \\ \hline
NULL & taskset & NULL \\ \hline
NULL & tee & NULL \\ \hline
NULL & telnet & NULL \\ \hline
NULL & telnetd & NULL \\ \hline
NULL & test & NULL \\ \hline
NULL & tftp & NULL \\ \hline
NULL & time & NULL \\ \hline
NULL & timeout & NULL \\ \hline
NULL & top & NULL \\ \hline
NULL & touch & NULL \\ \hline
NULL & tr & NULL \\ \hline
NULL & traceroute & NULL \\ \hline
NULL & traceroute6 & NULL \\ \hline
NULL & TRUE & NULL \\ \hline
NULL & tty & NULL \\ \hline
NULL & tunctl & NULL \\ \hline
NULL & udhcpc & NULL \\ \hline
NULL & udhcpd & NULL \\ \hline
NULL & umount & NULL \\ \hline
NULL & uname & NULL \\ \hline
NULL & uncompress & NULL \\ \hline
NULL & unexpand & NULL \\ \hline
NULL & uniq & NULL \\ \hline
NULL & unix2dos & NULL \\ \hline
NULL & unlzma & NULL \\ \hline
NULL & unlzop & NULL \\ \hline
NULL & unxz & NULL \\ \hline
NULL & unzip & NULL \\ \hline
NULL & uptime & NULL \\ \hline
NULL & usleep & NULL \\ \hline
NULL & uudecode & NULL \\ \hline
NULL & uuencode & NULL \\ \hline
NULL & vconfig & NULL \\ \hline
NULL & vi & NULL \\ \hline
NULL & watch & NULL \\ \hline
NULL & watchdog & NULL \\ \hline
NULL & wc & NULL \\ \hline
NULL & wget & NULL \\ \hline
NULL & which & NULL \\ \hline
NULL & who & NULL \\ \hline
NULL & whoami & NULL \\ \hline
NULL & xargs & NULL \\ \hline
NULL & xz & NULL \\ \hline
NULL & xzcat & NULL \\ \hline
NULL & yes & NULL \\ \hline
NULL & zcat & NULL \\ \hline

\end{longtable}
%\vspace{3mm}
%\setlength{\myheight}{10mm}
%\begin{table}[h]
% \caption{実装コマンド一覧}
% \label{table:command}
% \centering
%  \begin{tabular}{|c|c|}
%   \hline
%   Busyboxに含まれるコマンド & Cowrieの実装コマンド  \\
%    \hline \hline
%  \end{tabular}
%\end{table}
%\vspace{7mm}
% --------------------

%%% Local Variables:
%%% mode: japanese-latex
%%% TeX-master: "．．/bthesis"
%%% End:
